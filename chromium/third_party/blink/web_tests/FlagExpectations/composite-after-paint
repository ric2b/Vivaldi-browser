# tags: [ Android Fuchsia Linux Mac Mac10.12 Mac10.13 Win Win7 Win10 ]
# tags: [ Release Debug ]
# results: [ Timeout Crash Pass Failure Slow Skip ]

# Expectations for CompositeAfterPaint
# See: https://docs.google.com/document/d/1QCM912Dr6u38DqyQqd7pxQxDy8FFOoWMMDq7uAXqKdA/view
http/tests/devtools/tracing/* [ Skip ]

virtual/composite-after-paint/* [ Skip ]

virtual/layout_ng_block_frag/* [ Skip ]
virtual/layout_ng_fragment_traversal/* [ Skip ]
virtual/prefer_compositing_to_lcd_text/compositing/overflow/* [ Skip ]
virtual/stable/* [ Skip ]

# For now we track the failures of the base tests of the following virtual suites.
virtual/exotic-color-space/images/* [ Skip ]
virtual/gpu-rasterization/images/* [ Skip ]
virtual/threaded/printing/* [ Skip ]
virtual/threaded/http/tests/devtools/tracing/* [ Skip ]
virtual/controls-refresh-hc/* [ Skip ]
virtual/web-components-v0-disabled/* [ Skip ]

# They test Layer::ScrollsWithRespectTo() which is for pre-CompositeAfterPaint only.
compositing/overflow/scrolls-with-respect-to-nested.html [ Skip ]
compositing/overflow/scrolls-with-respect-to-transform.html [ Skip ]
compositing/overflow/scrolls-with-respect-to.html [ Skip ]

# We don't repaint when opacity changes from zero to non-zero, so it's not feasible
# to detect that as a first paint. Won't fix.
external/wpt/paint-timing/fcp-only/fcp-opacity.html [ Skip ]
external/wpt/paint-timing/fcp-only/fcp-pseudo-element-opacity.html [ Skip ]

# Can't rebaseline because the file path is too long.
virtual/compositor_threaded_scrollbar_scrolling/paint/invalidation/scroll/sticky/invalidate-after-composited-scroll-with-sticky.html [ Skip ]

# Fail before CompositeAfterPaint but pass with it.
crbug.com/802915 css3/blending/isolation-should-include-non-local-background.html [ Pass ]
crbug.com/918155 virtual/prefer_compositing_to_lcd_text/scrollbars/overlay-scrollbar-over-child-layer-nested-2.html [ Pass ]
crbug.com/918155 virtual/prefer_compositing_to_lcd_text/scrollbars/overlay-scrollbar-over-child-layer-nested.html [ Pass ]
paint/invalidation/compositing/subpixel-offset-scaled-transform-composited.html [ Pass ]

# With CompositeAfterPaint and LayoutNGFragmentItem enabled
crbug.com/1103138 paint/invalidation/compositing/float-under-composited-inline.html [ Pass Crash ]

# Raster invalidation doesn't work for huge layers.
paint/invalidation/raster-under-invalidation-checking.html [ Failure ]

# No composited scrolling for overflow:hidden (on marquee).
compositing/overflow/do-not-repaint-if-scrolling-composited-layers.html [ Failure ]

# Passes on bot, timeouts locally.
virtual/threaded/fast/events/pinch/scroll-visual-viewport-send-boundary-events.html [ Pass Timeout ]

paint/invalidation/media-audio-no-spurious-repaints.html [ Failure ]

# Outline paints incorrectly with columns. Needs LayoutNGBlockFragment.
crbug.com/1047358 paint/pagination/composited-paginated-outlined-box.html [ Failure ]

compositing/gestures/gesture-tapHighlight-composited-img.html [ Pass Failure ]
http/tests/images/image-decode-in-frame.html [ Pass Failure ]

# CompositeAfterPaint positions and scales root scrollbars incorrectly when
# a page scale factor is applied.
crbug.com/1106550 virtual/threaded-prefer-compositing/fast/scrolling/scrollbars/mouse-scrolling-on-div-scrollbar-thumb-scaled.html [ Failure ]

# Need to force the video to be composited in this case, or change pre-CAP
# to match CAP behavior.
crbug.com/1108972 fullscreen/compositor-touch-hit-rects-fullscreen-video-controls.html [ Failure ]
